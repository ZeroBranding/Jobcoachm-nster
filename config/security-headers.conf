# Security Headers Konfiguration für JobCoach Münster
# Diese Datei kann für Nginx, Apache oder andere Webserver verwendet werden

# =============================================================================
# NGINX KONFIGURATION
# =============================================================================

# Content Security Policy - Schutz vor XSS
add_header Content-Security-Policy "
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
    font-src 'self' https://fonts.gstatic.com;
    img-src 'self' data: https:;
    connect-src 'self';
    frame-src 'none';
    object-src 'none';
    base-uri 'self';
    form-action 'self';
    upgrade-insecure-requests;
" always;

# HTTP Strict Transport Security - HTTPS erzwingen
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

# Clickjacking-Schutz
add_header X-Frame-Options "SAMEORIGIN" always;

# MIME-Type Sniffing verhindern
add_header X-Content-Type-Options "nosniff" always;

# XSS-Filter aktivieren
add_header X-XSS-Protection "1; mode=block" always;

# Referrer Policy - Privacy-Schutz
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Permissions Policy - Browser-Features kontrollieren
add_header Permissions-Policy "
    camera=(),
    microphone=(self),
    geolocation=(),
    payment=(),
    usb=(),
    magnetometer=(),
    gyroscope=(),
    accelerometer=()
" always;

# Cross-Origin Policies
add_header Cross-Origin-Opener-Policy "same-origin" always;
add_header Cross-Origin-Embedder-Policy "require-corp" always;
add_header Cross-Origin-Resource-Policy "same-origin" always;

# =============================================================================
# APACHE KONFIGURATION (.htaccess)
# =============================================================================

# <IfModule mod_headers.c>
#     # Content Security Policy
#     Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self'; frame-src 'none'; object-src 'none'; base-uri 'self'; form-action 'self'; upgrade-insecure-requests;"
#     
#     # HTTP Strict Transport Security
#     Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
#     
#     # Weitere Security Headers
#     Header always set X-Frame-Options "SAMEORIGIN"
#     Header always set X-Content-Type-Options "nosniff"
#     Header always set X-XSS-Protection "1; mode=block"
#     Header always set Referrer-Policy "strict-origin-when-cross-origin"
#     Header always set Permissions-Policy "camera=(), microphone=(self), geolocation=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()"
# </IfModule>

# =============================================================================
# VERCEL KONFIGURATION (vercel.json)
# =============================================================================

# {
#   "headers": [
#     {
#       "source": "/(.*)",
#       "headers": [
#         {
#           "key": "Content-Security-Policy",
#           "value": "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self'; frame-src 'none'; object-src 'none'; base-uri 'self'; form-action 'self'; upgrade-insecure-requests;"
#         },
#         {
#           "key": "Strict-Transport-Security",
#           "value": "max-age=31536000; includeSubDomains; preload"
#         },
#         {
#           "key": "X-Frame-Options",
#           "value": "SAMEORIGIN"
#         },
#         {
#           "key": "X-Content-Type-Options",
#           "value": "nosniff"
#         },
#         {
#           "key": "X-XSS-Protection",
#           "value": "1; mode=block"
#         },
#         {
#           "key": "Referrer-Policy",
#           "value": "strict-origin-when-cross-origin"
#         }
#       ]
#     }
#   ]
# }